原文链接：http://www.cnblogs.com/codingbigdog/archive/2022/07/26/16522427.html
提交日期：Tue, 26 Jul 2022 11:51:00 GMT
博文内容：

                    <p>一，以太网的接口和线缆</p> 
<p>1，不同以太网标准的技术要求：传输介质与作用距离</p> 
<p>2，直连与交叉线的选择：不同种接口（指MDI和MDI-X）选直连，同种接口选交叉，现在能自适应，但旧设备要注意</p> 
<p>以太网接口标识：e，f，g</p> 
<p>S口是serial接口的意思，也叫高速异步串口，主要是连接广域网的V.35线缆用的，说白了就是路由器和路由器连接时候用的，可以用命令设置带宽，一般也就在10M、8M左右。</p> 
<p>F口是FastEthernet接口，叫快速以太网口，主要连接以太网（局域网）用的，说白了就是连接交换机或电脑用的，用普通的双绞线就可以连接，速率默认是100Mbps，可以用命令限速，但是不可能超过100Mbps。</p> 
<p>E口是Ethernet接口，叫以太网接口，也是主要连接以太网（局域网）用的，也是用普通的双绞线就可以连接，速率默认是10Mbps，现在新型的设备上已经把这个接口淘汰了。</p> 
<p>另外，路由器上还有一个必不可少的接口是Console口，叫控制口，这个接口是用来调试路由器的。</p> 
<p>另外有的路由器还有AUX接口，也是控制接口；</p> 
<p>G口，是千兆以太网接口，是连接以太网用的。</p> 
<p>3，（1）网络设备接口分MDI (Medium Dependent Interface，终端到网络连接设备 )和MDI_X（交叉，终端到终端）两种。</p> 
<p>（2）一般路由器的以太网接口、主机的网卡接口类型为MDI。交换机的接口类型可以为MDI或MDI_X。Hub(集线器)的接口类型为MDI_X。即：主机和路由器属于同种；交换机和Hub属于同种</p> 
<p>（3）双绞线可以分为直连网线和交叉网线，直连网线用于连接MDI和MDI_X，交叉网线用于连接MDI和MDI，或者MDI_X和MDI_X。即： &nbsp;&nbsp; &nbsp;直连用于不同种；交叉用于同种</p> 
<p>2、以太网有哪几种介质？ &nbsp; &nbsp;</p> 
<p>包括同轴电缆、双绞线和光纤。</p> 
<p>以太网有哪几种速率？ &nbsp; &nbsp;</p> 
<p>10M、100M、1000M、10G。</p> 
<p>二，了解以太网端口的几项基本技术：</p> 
<p>自协商--以太网速率提高而如何与原10M以太网设备兼容的问题（利旧问题）--常引起ping通问题</p> 
<p>流量控制—处理与发送速率不对等—网络的可靠性</p> 
<p>端口聚合：提高带宽和可靠性—设备的可靠性 &nbsp;</p> 
<p>端口镜像：大流量数据的备份与监测—数据的可靠性</p> 
<p>1，（1）自协商功能允许一个网络设备将自己所支持的工作模式信息传递给网络上的对端，并接受对方可能传递过来的相应信息</p> 
<p>自协商功能完全由物理层芯片设计实现，简单地是通过上电后测试脉冲实现的因此并不使用专用数据报文或带来任何高层协议开销。</p> 
<p>注意：只对双绞线T而言，对光纤通信不支持自协商，需手动配置两端速率/<span style="color:#86ca5e;"><strong>工作模式</strong></span>，如果光纤两端的配置不同，是不能通信的。（实验时需注意，ping不通的原因之一）</p> 
<p>（2）以太网电接口有下面三种双工模式</p> 
<p>全双工：端口同时发送和接收数据包</p> 
<p>半双工：端口同一时刻只能发送数据包或接收数据包</p> 
<p>自协商：端口双工状态由本端口和对端端口自动协商而定 &nbsp; &nbsp;</p> 
<p>以太网光接口只能工作在全双工模式下</p> 
<p>2，流量控制—处理与发送速率不对等（一般是交换机所具有的技术）</p> 
<p>半双工—发送csma/cd协议的模拟（不是真正）冲突信号，从而使对方停下</p> 
<p>全双工—不使用csma/cd协议，所以采用发送专门的pause帧，并用组播地址01-80-C2-00-00-01进行发送</p> 
<p>3，（1）端口聚合：也称为端口捆绑、端口聚集或链路聚合。 &nbsp; 端口聚合将多个接口聚合在一起形成1个汇聚组，以实现负载分担。从外面看起来，1个汇聚组好象就是1个接口&nbsp;。多根链路合并为一根eth-trunk，提高流量负载分组和可靠性（同组成员彼此动态备份）</p> 
<p>（2）端口聚合的优点：</p> 
<p>第一，增加网络带宽。端口聚合可以将多个连接的接口捆绑成为一个逻辑端口，捆绑后的带宽是每个独立接口的带宽总和。当接口上的流量增加而成为限制网络性能的瓶颈时，采用支持该特性的交换机可以轻而易举地增加网络的带宽（例如，可以将2－4个100Mbit/s端口连接在一起组成一个200—400Mbit/s的连接）</p> 
<p>第二，提高网络连接的可靠性。当主干网络以很高的速率连接时，一旦出现网络连接故障，将会导致大量的数据丢失。高速服务器以及主干网络连接必须保证绝对的可靠。采用端口聚合技术可以保障网络连接的可靠性。例如，将一根电缆错误地拔下来不会导致链路中断。也就是说，组成端口聚合的某一接口连接失败，网络数据将自动重定向到那些正常工作的连接上。这个过程非常快，只需要更改一个访问地址就可以了。然后，交换机将数据转到其他端口，该特性可以保证网络无间断地工作。</p> 
<p>（3）端口聚合的限制条件</p> 
<p>&nbsp; 端口聚合两端的物理参数必须保持一致 进行聚合的链路的数目 、进行聚合的链路的速率 、进行聚合的链路的双工方式 &nbsp;</p> 
<p>&nbsp; 端口聚合两端的逻辑参数必须保持一致：同一个汇聚组中端口的基本配置必须保持一致，基本配置主要包括STP、QoS、VLAN、端口等相关配置</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STP配置一致，包括：端口的STP开启/关闭、与端口相连的链路属性（如点对点或非点对点）、STP优先级、路径开&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; 销、报文发送速率限制、是否环路保护、是否根保护、是否为边缘端口。</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;QoS配置一致，包括：流量限速、优先级标记、缺省的802.1p优先级、带宽保证、拥塞避免、流重定向、流量统计等。</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;VLAN配置一致，包括：接口上允许通过的VLAN、接口缺省VLAN ID。 接口配置一致，包括：接口的链路类型，如&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Trunk、Hybrid、Access属性。</p> 
<p>4，端口镜像：端口镜像一般应用于流量观测和故障定位中，它把特定的业务数据复制一份，传送到监控设备，然后进行镜像数据分析。 端口镜像可以分为基于端口的镜像和基于流的镜像两种。大流量，如视频流量拷贝到其他端口</p> 
<p>（1）基于端口的镜像是把被镜像端口的进出数据报文完全拷贝一份到镜像端口，进行流量观测或者故障定位</p> 
<p>（2）基于流的镜像只对满足条件的数据流进行镜像。这些流可能具有相同的目地地址，端口号等，可根据需求灵活定义。</p> 
<p>5，问题：</p> 
<p>（1）什么是自协商技术？ &nbsp;</p> 
<p>自协商技术是为了解决不同速率以太网设备之间的兼容性，协商内容包括端口的速度、双工模式等。</p> 
<p>（2）半双工流量控制和全双工流量控制有什么区别？ &nbsp; &nbsp;</p> 
<p>半双工流量控制使用反向压力（backpressure）方法，当网络拥塞时，交换机将插入“载波检测”或者强行制造一次冲突。 &nbsp; &nbsp;在全双工情况下，IEEE 802.3x规定了一种64字节的“PAUSE”MAC控制帧的格式。当端口发生阻塞时，交换机向信息源发送“PAUSE”帧，告诉信息源暂停一段时间再发送信息。</p> 
<p>（3）端口汇聚和端口镜像有什么作用？ &nbsp; &nbsp;</p> 
<p>端口汇聚可以提高链路带宽，实现流量负载分担，提高网络的可靠性；&nbsp;端口镜像一般应用于流量观测和故障定位中，它把特定的业务数据复制一份，传送到监控设备，然后进行镜像数据分析。</p> 
<p>三，VLAN技术原理和配置</p> 
<p>可以先看这个:<a href="https://baijiahao.baidu.com/s?id=1628398215665219628&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1628398215665219628&amp;wfr=spider&amp;for=pc</a></p> 
<p>1，VLAN产生的原因：传统的以太网交换机在转发数据时，采用源地址学习的方式，自动学习各个端口连接的主机的MAC地址，形成转发表，然后依据此表进行以太网帧的转发，整个转发的过程自动完成，所有端口都可以互访，维护人员无法控制端口之间的转发。 该网络存在如下缺陷：</p> 
<p>网络的安全性差。由于各个端口之间可以直接互访，增加了用户进行网络攻击的可能性。</p> 
<p>网络效率低。用户可能收到大量不需要的报文，这些报文同时消耗网络带宽资源和客户主机CPU资源，例如不必要的广播报文。</p> 
<p>业务扩展能力差。网络设备平等的对待每台主机的报文，无法实现有差别的服务，例如无法优先转发用于网络管理的以太网帧。</p> 
<p>2，VLAN技术的目标：VLAN(Virtual Local Area Networks)技术把用户划分成多个逻辑的网络(group)，组内可以通信，组间不允许通信。二层转发的单播、组播、广播报文只能在组内转发，并且很容易地实现组成员的添加或删除。</p> 
<p>3，通过标签管理实现VLAN：在现有的交换网络环境中，以太网的帧有两种格式： 没有加上VLAN标记的标准以太网帧（untagged frame）；有VLAN标记(VLANID)的以太网帧（tagged frame).支持VLAN技术的交换机，转发以太网帧时不再仅仅依据目的MAC地址，同时还要考虑该端口的VLAN配置情况，从而实现对二层转发的控制.</p> 
<p>4,确定标签中的VLAN ID取值：</p> 
<p>(1)基于端口：网络管理员给交换机的每个端口配置PVID，即Port VLAN ID，有些场合称为端口默认VLAN。如果收到的是untagged帧，则VLAN ID的取值为PVID。</p> 
<p>(2)基于MAC地址：网络管理员配置好MAC地址和VLAN ID的映射关系表，如果收到的是untagged帧，则依据该表添加VLAN ID。</p> 
<p>(3)基于协议：网络管理员配置好以太网帧中的协议域和VLAN ID的映射关系表，如果收到的是untagged帧，则依据该表添加VLAN ID。</p> 
<p>(4)基于子网：根据报文中的IP地址信息，确定添加的VLAN ID。</p> 
<p>(5)基于策略：安全性非常高，基于MAC地址+IP地址、MAC地址+IP地址+接口。成功划分VLAN后，可以达到禁止用户改变IP地址或MAC地址的目的。</p> 
<p>注意1:所有以太网帧在交换机内都是以tagged frame的形式流动的，即某端口从本交换机其他端口收到的帧一定是tagged的。 但端口从对端设备收到的帧，可能是untagged或者是tagged的，如果收到的是tagged frame，则进入转发过程，如果该端口收到的是untagged frame，则必须加上标签。 简单地说从交换机内部收到的帧不需要加标签处理；从对端收到的可能需要加标签</p> 
<p>注意2:设备同时支持多种方式时，一般情况下，优先使用顺序为：基于策略→基于MAC地址→基于子网→基于协议→基于端口。 基于端口划分VLAN的优先级最低，但是是最常用的VLAN划分方式。</p> 
<p>5,交换机端口类型</p> 
<p>引入VLAN功能后，交换机的接口被划分为三种类型Access接口、Trunk接口、Hybrid接口，及三种链路类型：access、trunk、hybrid。</p> 
<p>(1)access类型只属于一个VLAN，一般用于连接计算机端口。</p> 
<p>Access接口，用于连接主机，有如下特点：</p> 
<p>&nbsp;仅仅允许唯一的VLAN ID通过本接口，这个值与接口的PVID相同。</p> 
<p>如果该接口收到的对端设备发送的帧是untagged，交换机将强制加上该接口的PVID。</p> 
<p>Access接口发往对端设备的以太网帧永远是untagged frame。</p> 
<p>很多型号的交换机默认接口类型是access，PVID默认是1，VLAN 1由系统创建，不能被删除。</p> 
<p>(2)trunk类型可以允许多个vlan通过，可以接收和发送多个vlan的报文，一般用于交换机之间的端口。</p> 
<p>(3)hybrid类型可以允许多个vlan通过，可以接受和发送多个vlan的报文，可以用于交换机之间连接，也可以用于连接用户计算机。</p> 
<p><img alt="" class="has" height="347" src="https://img-blog.csdnimg.cn/20191102184537542.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNzc1OTM4,size_16,color_FFFFFF,t_70" width="834"></p> 
<p>(3)Access端口的收发规则：不接收带标签的数据包，发出的数据包也是不带标签的</p> 
<p>Trunk端口的收发规则：接收带标签的数据包，发出的数据包也是带标签</p> 
<p>6,问题:1.交换机有哪几种端口类型？</p> 
<p>答：access、trunk、hybrid。</p> 
<p>2.Trunk端口发往对端设备的一定是tagged frame吗？</p> 
<p>答：大多数情况下是tagged frame，但是如果待转发帧的VLAN ID与PVID值相同，则移除标签后转发。</p> 
<p>四,VLAN路由</p> 
<p>具体还是看这个:<a href="https://baijiahao.baidu.com/s?id=1628398215665219628&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1628398215665219628&amp;wfr=spider&amp;for=pc</a></p> 
<p>1,VLAN路由的原理：与真实的LAN类而不同，真实的只用路由器，VlAN的可以用三层交换机</p> 
<p>&nbsp;2,二层交换机和路由器在功能上的集成构成了三层交换机，三层交换机在功能上实现了VLAN的划分、VLAN内部的二层交换和VLAN间路由的功能。(这时相当于二层交换机+路由器=三层交换机,或者说是一个内置了路由软件的二层交换机)</p> 
<p>3,VLAN路由的目的是什么？</p> 
<p>答：VLAN的优点是可以隔离广播域，但这也引起另外一个问题，就是广播域之间如果需要通信的话，那怎么办呢？在这里就提出了VLAN路由的概念，目的就是为了实现不同VLAN间的相互通信</p> 
<p>4.实现VLAN间的通信有多少种方法？</p> 
<p>答：如果交换是普通的二层交换机的话，只能通过路由器配置单臂路由实现VLAN间的通信；但如果交换是三层交换机，可以通过配置三层VLAN接口实现VLAN间的通信。</p> 
<p>&nbsp;</p> 
<p>五,1,STP概述:</p> 
<p>(1)生成树产生的原因：透明网桥的自学习算法中的广播算法与冗余环路结合带来的广播风暴问题；同路由表类似的MAC表的不稳定收敛 (即环路引起的问题:广播风暴和MAC地址表不稳定)</p> 
<p>(2)生成树协议STP的作用：消除环路/提供备份</p> 
<p>(3)生成树协议STP的基本原理：以树形是连通的/无环路的最小子图</p> 
<p>(4)STP协议中的几个基本概念和选取方法：根桥/根端口/指定端口/替换备份端口；选取优先级+MAC地址较小者（与DR中的IP地址不一样）--多个交换机相连时并非所有端口都是活动的)</p> 
<p>2,生成树基本计算过程:STP协议中定义了根桥（Root Bridge）、根端口（Root Port）、指定端口（Designated Port）、路径开销（Path Cost）等概念。通过构造一棵树的方法达到裁剪冗余的环路的目的，同时实现链路备份和路径最优化。用于构造这棵树的算法称为生成树算法SPA（Spanning Tree Algorithm）。 为了计算生成树，交换机之间需要交换相关信息和参数，这些信息和参数被封装在配置BPDU（Configuration Bridge Protocol Data Unit）中，在交换机之间传递</p> 
<p>生成树形成概述:1. 从所有的网桥（交换机是多端口的网桥）中选择一个作为根网桥；</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2. 计算从本网桥到根网桥的最短路径；</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3. 对每一个共享网段，选择距根桥最近的网桥作为指定网桥，负责该网段的数据转发；</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 对每一个网桥，选择一个根端口。从根端口给出的路径是从本网桥到根网桥的最短路径；</p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.选择除根端口以外的指定端口。</p> 
<p>具体行为,自行百度</p> 
<p>3,STP存在的问题</p> 
<p>(1)临时环路问题</p> 
<p>解决临时环路的方法是：在一个端口从不转发状态进入转发状态之前，需要等待一个足够长的时间，以使需要进入不转发状态的端口有足够时间完成生成树计算，并进入不转发状态。</p> 
<p>(2)部分VLAN不能互通:</p> 
<p>解决方法:多生成树协议MSTP</p> 
<p>4,问题:</p> 
<p>生成树协议如何在网络中计算出一棵无环的树？</p> 
<p>在网络中选出一个根交换机，为每个非根交换机选择一个根端口，为每个网段选择一个指定端口，将既不是根端口也不是指定端口的端口设为阻塞状态。</p> 
<p>生成树协议如何解决临时环路问题？</p> 
<p>当一个端口从不转发状态转为转发状态之前，要经过两个Forward Delay间隔，以确保网络中其它交换机完成生成树计算。</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p>
                